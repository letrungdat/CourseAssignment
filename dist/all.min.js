function _removeTime(e){return e.hour(0).minute(0).second(0).millisecond(0)}function _buildMonth(e,t,r,a){e.weeks=[];for(var o=!1,n=t.clone(),l=n.month(),i=0;!o;)e.weeks.push({days:_buildWeek(n.clone(),r,a)}),n.add(1,"w"),o=i++>2&&l!==n.month(),l=n.month()}function _buildWeek(e,t,r){for(var a=[],o=0;7>o;o++){var n=checkMatch(e,r);a.push({name:e.format("dd").substring(0,1),number:e.date(),isCurrentMonth:e.month()===t.month(),isToday:e.isSame(new Date,"day"),date:e,haveMatch:n,match:getMatch(e,r)}),e=e.clone(),e.add(1,"d")}return a}function checkMatch(e,t){var r=!1;for(var a in t)if(t.hasOwnProperty(a)){var o=t[a].date;e.isSame(moment(o,"DD/MM/YYYY"))&&(r=!0)}return r}function getMatch(e,t){for(var r in t)if(t.hasOwnProperty(r)){var a=t[r].date;if(e.isSame(moment(a,"DD/MM/YYYY")))return t[r]}return""}var app=angular.module("myApp",["firebase","ngRoute","ngAnimate","ui.bootstrap"]);app.config(["$routeProvider",function(e){e.when("/",{templateUrl:"template/home.html",controller:"homeController"}).when("/team",{templateUrl:"template/team.html",controller:"teamController"}).when("/table",{templateUrl:"template/table.html",controller:"tableController"}).when("/player/:num",{templateUrl:"template/player.html",controller:"playerController"}).when("/calendar",{templateUrl:"template/calendar.html",controller:"calendarController"}).otherwise({redirectTo:"/"})}]),app.controller("MyController",["$scope","$firebaseArray",function(e,t){e.page={},e.page.title="",e.menuClick=function(){$("#container").toggleClass("open")}}]),app.controller("homeController",["$scope","$firebaseArray",function(e,t){var r=new Firebase("https://cscassignment.firebaseio.com/");e.page.title="HOME",e.news=t(r.child("news")),e.teamCalendars=t(r.child("teamCalendar").orderByChild("date").startAt(moment().format("DD/MM/YYYY")).limit(3))}]),app.controller("playerController",["$scope","$firebaseArray","$routeParams",function(e,t,r){e.page.title="PLAYER DETAIL";var a=new Firebase("https://cscassignment.firebaseio.com/"),o=r.num;e.players=t(a.child("teamMembers").orderByChild("number").equalTo(parseInt(o)))}]),app.controller("teamController",["$scope","$firebaseArray",function(e,t){var r=new Firebase("https://cscassignment.firebaseio.com/");e.page.title="SQUAD",e.goalkeepers=t(r.child("teamMembers").orderByChild("type").equalTo("G")),e.defenders=t(r.child("teamMembers").orderByChild("type").equalTo("D")),e.midfielders=t(r.child("teamMembers").orderByChild("type").equalTo("M")),e.strikers=t(r.child("teamMembers").orderByChild("type").equalTo("S"))}]),app.controller("tableController",["$scope","$firebaseArray",function(e,t){e.page.title="TABLE";var r=new Firebase("https://cscassignment.firebaseio.com/leagueTable");e.table=t(r.orderByChild("position"))}]),app.controller("calendarController",["$scope","$firebaseArray",function(e,t){e.page.title="Calendar";var r={},a=!0,o=new Firebase("https://cscassignment.firebaseio.com/teamCalendar");o.on("value",function(e){r=e.val()}),e.teamCalendars=t(o.orderByChild("date").startAt(moment().format("DD/MM/YYYY"))),e.day=moment().date,e.selected=_removeTime(e.selected||moment()),e.month=e.selected.clone();var n=e.selected.clone();n.date(1),_removeTime(n.day(0)),_buildMonth(e,n,e.month,r),e.select=function(t){e.selected=t.date},e.changeView=function(e){"calendar"===e?a||($("#calendar-view").toggleClass("show"),$("#list-view").toggleClass("show"),a=!0):a&&($("#calendar-view").toggleClass("show"),$("#list-view").toggleClass("show"),a=!1)},e.next=function(){var t=e.month.clone();_removeTime(t.month(t.month()+1).date(1).day(0)),e.month.month(e.month.month()+1),_buildMonth(e,t,e.month,r)},e.previous=function(){var t=e.month.clone();_removeTime(t.month(t.month()-1).date(1).day(0)),e.month.month(e.month.month()-1),_buildMonth(e,t,e.month,r)}}]);