function _removeTime(e){return e.hour(0).minute(0).second(0).millisecond(0)}function _buildMonth(e,t,a,r){e.weeks=[];for(var o=!1,n=t.clone(),l=n.month(),m=0;!o;)e.weeks.push({days:_buildWeek(n.clone(),a,r)}),n.add(1,"w"),o=m++>2&&l!==n.month(),l=n.month()}function _buildWeek(e,t,a){for(var r=[],o=0;7>o;o++){var n=checkMatch(e,a);r.push({name:e.format("dd").substring(0,1),number:e.date(),isCurrentMonth:e.month()===t.month(),isToday:e.isSame(new Date,"day"),date:e,haveMatch:n,match:getMatch(e,a)}),e=e.clone(),e.add(1,"d")}return r}function checkMatch(e,t){var a=!1;for(var r in t)if(t.hasOwnProperty(r)){var o=t[r].date;e.isSame(moment(o,"DD/MM/YYYY"))&&(a=!0)}return a}function getMatch(e,t){for(var a in t)if(t.hasOwnProperty(a)){var r=t[a].date;if(e.isSame(moment(r,"DD/MM/YYYY")))return t[a]}return""}var app=angular.module("myApp",["firebase","ngRoute","ngAnimate","ui.bootstrap"]);app.config(["$routeProvider",function(e){e.when("/",{templateUrl:"template/home.html",controller:"homeController"}).when("/team",{templateUrl:"template/team.html",controller:"teamController"}).when("/table",{templateUrl:"template/table.html",controller:"tableController"}).when("/player/:num",{templateUrl:"template/player.html",controller:"playerController"}).when("/calendar",{templateUrl:"template/calendar.html",controller:"calendarController"}).otherwise({redirectTo:"/"})}]),app.controller("MyController",["$scope","$firebaseArray",function(e,t){e.teamName="Manchester United",e.pageIcon="image/team/manu-logo.png",e.leagueLogo="image/Premier_League_logo.svg",e.leagueName="Barclays Preimer League",e.page={},e.page.title="",e.menuClick=function(){$("#container").toggleClass("open")}}]),app.controller("homeController",["$scope","$firebaseArray",function(e,t){var a=new Firebase("https://cscassignment.firebaseio.com/");e.page.title="Home",e.news=t(a.child("news")),e.teamCalendars=t(a.child("teamCalendar").orderByChild("date").startAt(moment().format("DD/MM/YYYY")).limit(3))}]),app.controller("playerController",["$scope","$firebaseArray","$routeParams",function(e,t,a){e.page.title="Player Detail";var r=new Firebase("https://cscassignment.firebaseio.com/"),o=a.num;e.players=t(r.child("teamMembers").orderByChild("number").equalTo(parseInt(o)))}]),app.controller("teamController",["$scope","$firebaseArray",function(e,t){var a=new Firebase("https://cscassignment.firebaseio.com/");e.page.title="Squad",e.goalkeepers=t(a.child("teamMembers").orderByChild("type").equalTo("G")),e.defenders=t(a.child("teamMembers").orderByChild("type").equalTo("D")),e.midfielders=t(a.child("teamMembers").orderByChild("type").equalTo("M")),e.strikers=t(a.child("teamMembers").orderByChild("type").equalTo("S"))}]),app.controller("tableController",["$scope","$firebaseArray",function(e,t){e.page.title="TABLE";var a=new Firebase("https://cscassignment.firebaseio.com/leagueTable");e.table=t(a.orderByChild("position"))}]),app.controller("calendarController",["$scope","$firebaseArray",function(e,t){e.page.title="Calendar";var a={},r=!0,o=new Firebase("https://cscassignment.firebaseio.com/teamCalendar");o.on("value",function(e){a=e.val()}),e.teamCalendars=t(o.orderByChild("date").startAt(moment().format("DD/MM/YYYY"))),e.day=moment().date,e.selected=_removeTime(e.selected||moment()),e.month=e.selected.clone();var n=e.selected.clone();n.date(1),_removeTime(n.day(0)),_buildMonth(e,n,e.month,a),e.select=function(t){e.selected=t.date},e.changeView=function(e){"calendar"===e?r||($("#calendar-view").toggleClass("show"),$("#list-view").toggleClass("show"),r=!0):r&&($("#calendar-view").toggleClass("show"),$("#list-view").toggleClass("show"),r=!1)},e.next=function(){var t=e.month.clone();_removeTime(t.month(t.month()+1).date(1).day(0)),e.month.month(e.month.month()+1),_buildMonth(e,t,e.month,a)},e.previous=function(){var t=e.month.clone();_removeTime(t.month(t.month()-1).date(1).day(0)),e.month.month(e.month.month()-1),_buildMonth(e,t,e.month,a)}}]);